{% extends "base.html" %}
{% block content %}
    <h1>Archivio dei Post</h1>
    
    <form method="get" action="{{ url_for('main.archive') }}">
        <label for="author">Filtra per autore:</label>
        <select name="author" id="author">
        <option value="">Tutti</option>
        {% for author in authors %}
            <option value="{{ author.id }}" {% if request.args.get('author', type=int) == author.id %}selected{% endif %}>{{ author.username }}</option>
        {% endfor %}
        </select>
        <button type="submit">Filtra</button>
    </form>
    
    <hr>
    
    {% for post in posts %}
        <article>
        <header>
            <h2>{{ post['title'] }}</h2>
            <small>Scritto da <strong>{{ post['username'] }}</strong> il {{ post['created'].strftime('%Y-%m-%d') }}</small>
        </header>
        
        <p>{{ post['body'] }}</p>
        
        {% if g.user and g.user['id'] == post['author_id'] %}
            <a href="{{ url_for('main.update', id=post['id']) }}">Modifica</a>
        {% endif %}
        </article>
        <hr>
    {% endfor %}
    {% endblock %}